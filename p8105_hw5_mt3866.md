p8105_hw5_mt3866
================
2025-11-13

Load libraries

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(rvest)
```

    ## 
    ## Attaching package: 'rvest'
    ## 
    ## The following object is masked from 'package:readr':
    ## 
    ##     guess_encoding

``` r
library(broom)
```

Q1 Write a function that randomly draws birthdays out of 365 days & run
the function 10000 times for each group size 2-50

``` r
sim_birthday = function (n) {
birthdays = sample(1:365, n, replace = TRUE)
any(duplicated(birthdays))
}
birthday_results = expand_grid(
  groupsize = 2:50,
  iter = 1:10000
)|>
  mutate(duplicate=map_lgl(groupsize, sim_birthday))|>
  group_by(groupsize)|>
  summarize(prob=mean(duplicate))
```

Make a plot

``` r
ggplot(birthday_results, aes(x=groupsize, y=prob)) +
  geom_point() +
  labs(
    x = "group size",
    y = "probability"
  )
```

![](p8105_hw5_mt3866_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->
This plot shows that as the group size increases, the probability that
at least two people in the group will share a birthday increases as
well. These two variables seem to have a direct and positive
relationship with each other.

Q2

Follow the mean, sd, and n requirement, generate 5,000 samples. Repeat
for mu = 1 to 6 and test null

``` r
sim_test = function(n = 30, mu = 0, sigma = 5, alpha = 0.05) {
x = rnorm(n = n, mean = mu, sd = sigma)
  t_res = t.test (x, mu = 0)
  tidy(t_res) |> 
    select(estimate, p.value) |> 
    rename(mu_hat = estimate)
}


sim_results =
  expand_grid(
  mu = 0:6 ,
  iter = 1:5000) |>
  mutate(res = map2(mu, iter, ~sim_test (n = 30, mu = .x, sigma = 5)))|>
  unnest(res)

power_res = sim_results |>
  group_by(mu) |>
  summarize(power = mean(p.value < 0.05))
```

Create plot

``` r
ggplot(power_res, aes(x = mu, y = power)) +
  geom_point(size = 5) +
  geom_line() +
  labs(
    x = "mean",
    y = "power"
  )
```

![](p8105_hw5_mt3866_files/figure-gfm/unnamed-chunk-5-1.png)<!-- -->
